{% extends "base.html" %}

{% block title %}AI ì•Œê³ ë¦¬ì¦˜ - LottoPro-AI{% endblock %}
{% block nav_algorithms %}active{% endblock %}

{% block content %}
<div class="algorithms-container">
    <div class="algorithms-header">
        <h1>ğŸ§  AI ì•Œê³ ë¦¬ì¦˜</h1>
        <p class="subtitle">ê°ê¸° ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” 8ê°€ì§€ ë…ìì  AI ëª¨ë¸ë¡œ<br>ìµœê³ ì˜ ë¡œë˜ ì˜ˆì¸¡ ì •í™•ë„ë¥¼ ê²½í—˜í•´ë³´ì„¸ìš”</p>
    </div>

    <!-- í•„í„° ì»¨íŠ¸ë¡¤ -->
    <div class="filter-controls">
        <div class="control-group">
            <label for="sort-select">
                <span class="control-icon">ğŸ“Š</span>
                ì •ë ¬:
            </label>
            <select id="sort-select" class="control-select">
                <option value="accuracy" selected>ì •í™•ë„ìˆœ</option>
                <option value="name">ì´ë¦„ìˆœ</option>
            </select>
        </div>

        <div class="control-group">
            <label for="filter-select">
                <span class="control-icon">ğŸ”</span>
                í•„í„°:
            </label>
            <select id="filter-select" class="control-select">
                <option value="all" selected>ì „ì²´</option>
                <option value="high">ë†’ì€ ì •í™•ë„ (85%+)</option>
                <option value="medium">ì¤‘ê°„ ì •í™•ë„ (70-85%)</option>
                <option value="low">ê¸°íƒ€ (70% ë¯¸ë§Œ)</option>
            </select>
        </div>

        <div class="control-group">
            <button id="refresh-btn" class="control-button">
                <span class="btn-icon">ğŸ”„</span>
                <span class="btn-text">ìƒˆë¡œê³ ì¹¨</span>
            </button>
        </div>
    </div>

    <!-- ì•Œê³ ë¦¬ì¦˜ ê·¸ë¦¬ë“œ -->
    <div id="algorithm-grid" class="algorithm-grid">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>ì•Œê³ ë¦¬ì¦˜ ë¡œë”© ì¤‘...</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ§  ì•Œê³ ë¦¬ì¦˜ í˜ì´ì§€ ì´ˆê¸°í™”');

    // ì •ë ¬ ì´ë²¤íŠ¸
    const sortSelect = document.getElementById('sort-select');
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            const sortBy = this.value;
            const filterBy = document.getElementById('filter-select')?.value || 'all';
            console.log('ì •ë ¬ ë³€ê²½:', sortBy);
            if (window.githubAPIManager) {
                window.githubAPIManager.renderAlgorithmCards('algorithm-grid', sortBy, filterBy);
            }
        });
    }

    // í•„í„° ì´ë²¤íŠ¸
    const filterSelect = document.getElementById('filter-select');
    if (filterSelect) {
        filterSelect.addEventListener('change', function() {
            const filterBy = this.value;
            const sortBy = document.getElementById('sort-select')?.value || 'accuracy';
            console.log('í•„í„° ë³€ê²½:', filterBy);
            if (window.githubAPIManager) {
                window.githubAPIManager.renderAlgorithmCards('algorithm-grid', sortBy, filterBy);
            }
        });
    }

    // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
    const refreshBtn = document.getElementById('refresh-btn');
    if (refreshBtn) {
        refreshBtn.addEventListener('click', async function() {
            console.log('ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            this.disabled = true;
            this.innerHTML = '<span class="btn-icon">â³</span><span class="btn-text">ë¡œë”© ì¤‘...</span>';
            
            if (window.githubAPIManager) {
                await window.githubAPIManager.loadAlgorithmInfo();
                const sortBy = document.getElementById('sort-select')?.value || 'accuracy';
                const filterBy = document.getElementById('filter-select')?.value || 'all';
                window.githubAPIManager.renderAlgorithmCards('algorithm-grid', sortBy, filterBy);
            }
            
            this.disabled = false;
            this.innerHTML = '<span class="btn-icon">ğŸ”„</span><span class="btn-text">ìƒˆë¡œê³ ì¹¨</span>';
        });
    }
});

// ë²ˆí˜¸ ì €ì¥ í•¨ìˆ˜
function saveNumbers(numbers) {
    console.log('ë²ˆí˜¸ ì €ì¥:', numbers);
    
    try {
        const savedNumbers = JSON.parse(localStorage.getItem('savedNumbers') || '[]');
        const newEntry = {
            id: Date.now(),
            numbers: numbers,
            timestamp: new Date().toISOString(),
            algorithm: 'AI ì˜ˆì¸¡',
            checked: false
        };
        
        savedNumbers.unshift(newEntry); // ë§¨ ì•ì— ì¶”ê°€
        localStorage.setItem('savedNumbers', JSON.stringify(savedNumbers));
        
        alert('ë²ˆí˜¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ì €ì¥ëœ ë²ˆí˜¸ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        
        // ì €ì¥ëœ ê°œìˆ˜ í‘œì‹œ
        console.log('ì´ ì €ì¥ëœ ë²ˆí˜¸:', savedNumbers.length);
    } catch (error) {
        console.error('ì €ì¥ ì‹¤íŒ¨:', error);
        alert('ë²ˆí˜¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    }
}
</script>
{% endblock %}
